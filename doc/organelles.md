# Assemble organelles by ANCHR

[TOC levels=1-3]: # " "
- [Assemble organelles by ANCHR](#assemble-organelles-by-anchr)
- [S288c organelles](#s288c-organelles)
    - [s288cO: download](#s288co-download)
    - [s288cO: template](#s288co-template)
    - [s288cO: run](#s288co-run)
- [*Arabidopsis thaliana* Col-0 organelles](#arabidopsis-thaliana-col-0-organelles)
    - [col_0O: download](#col_0o-download)
    - [col_0O: template](#col_0o-template)
    - [col_0O: run](#col_0o-run)
- [*Oryza sativa* Japonica Group Nipponbare organelles](#oryza-sativa-japonica-group-nipponbare-organelles)
    - [nipO: download](#nipo-download)
    - [nipO: template](#nipo-template)
    - [nipO: run](#nipo-run)


# S288c organelles

* Genome: GCF_000146045.2, 12.1571 Mb
* Mitochondrion: NC_001224, 85779 bp

## s288cO: download

* Reference genome

```bash
mkdir -p ${HOME}/data/anchr/s288cO/1_genome
cd ${HOME}/data/anchr/s288cO/1_genome

for ACCESSION in "NC_001224"; do
    URL=$(printf "https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=nucleotide&rettype=%s&id=%s&retmode=text" "fasta" "${ACCESSION}");
    curl $URL -o ${ACCESSION}.fa
done

TAB=$'\t'
cat <<EOF > replace.tsv
NC_001224.1${TAB}Mt
EOF

cat NC_001224.fa |
    faops replace stdin replace.tsv stdout |
    faops order stdin <(echo Mt) genome.fa

```

* Illumina
    * ERR1938683
    * 995.5 Mb
    * ~81.9x

```bash
mkdir -p ${HOME}/data/anchr/s288cO/2_illumina
cd ${HOME}/data/anchr/s288cO/2_illumina

cp ${HOME}/data/anchr/s288c/2_illumina/ERR1938683_{1,2}.fastq.gz .

ln -fs ERR1938683_1.fastq.gz R1.fq.gz
ln -fs ERR1938683_2.fastq.gz R2.fq.gz

```

## s288cO: template

* Rsync to hpcc

```bash
rsync -avP \
    ~/data/anchr/s288cO/ \
    wangq@202.119.37.251:data/anchr/s288cO

# rsync -avP wangq@202.119.37.251:data/anchr/s288cO/ ~/data/anchr/s288cO

```


* template

```bash
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=s288cO

cd ${WORKING_DIR}/${BASE_NAME}

rm -f *.sh
anchr template \
    . \
    --basename ${BASE_NAME} \
    --queue mpi \
    --genome 200_000 \
    --fastqc \
    --kmergenie \
    --insertsize \
    --sgapreqc \
    --trim2 "--dedupe --cutoff 328 --cutk 31" \
    --qual2 "25" \
    --len2 "60" \
    --filter "adapter,artifact" \
    --mergereads \
    --ecphase "1,2,3" \
    --cov2 "40 80 120 160 240 320" \
    --tadpole \
    --splitp 100 \
    --statp 2 \
    --fillanchor \
    --xmx 110g \
    --parallel 24

```

## s288cO: run

```bash
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=s288cO

cd ${WORKING_DIR}/${BASE_NAME}
# rm -fr 4_*/ 6_*/ 7_*/ 8_*/ && rm -fr 2_illumina/trim 2_illumina/mergereads statReads.md 

bash 0_bsub.sh
# bkill -J "${BASE_NAME}-*"

# bash 0_master.sh
# bash 0_cleanup.sh

```

Table: statInsertSize

| Group             |  Mean | Median | STDev | PercentOfPairs/PairOrientation |
|:------------------|------:|-------:|------:|-------------------------------:|
| R.genome.bbtools  |   0.0 |      0 |   0.0 |                          0.00% |
| R.tadpole.bbtools | 394.9 |    361 | 139.3 |                         42.87% |
| R.tadpole.picard  | 394.4 |    360 | 139.4 |                             FR |


Table: statReads

| Name       |   N50 |     Sum |       # |
|:-----------|------:|--------:|--------:|
| Genome     | 85779 |   85779 |       1 |
| Illumina.R |   150 | 995.54M | 6636934 |
| trim.R     |   150 | 177.18M | 1184286 |
| Q25L60     |   150 | 168.71M | 1142921 |


Table: statTrimReads

| Name     | N50 |     Sum |       # |
|:---------|----:|--------:|--------:|
| clumpify | 150 | 992.93M | 6619558 |
| highpass | 150 | 177.92M | 1186106 |
| trim     | 150 | 177.18M | 1184286 |
| filter   | 150 | 177.18M | 1184286 |
| R1       | 150 |  88.66M |  592143 |
| R2       | 150 |  88.52M |  592143 |
| Rs       |   0 |       0 |       0 |


```text
#R.trim
#Matched	1612	0.13591%
#Name	Reads	ReadsPct
```

```text
#R.filter
#Matched	0	0.00000%
#Name	Reads	ReadsPct
```

```text
#R.peaks
#k	31
#unique_kmers	3672612
#main_peak	508
#genome_size	238322
#haploid_genome_size	238322
#fold_coverage	508
#haploid_fold_coverage	508
#ploidy	1
#percent_repeat	90.205
#start	center	stop	max	volume
```


Table: statMergeReads

| Name          | N50 |     Sum |       # |
|:--------------|----:|--------:|--------:|
| clumped       | 150 | 177.17M | 1184220 |
| ecco          | 150 | 177.17M | 1184220 |
| eccc          | 150 | 177.17M | 1184220 |
| ecct          | 150 | 167.44M | 1117996 |
| extended      | 190 | 210.03M | 1117996 |
| merged.raw    | 380 | 145.84M |  394142 |
| unmerged.raw  | 190 |  61.26M |  329712 |
| unmerged.trim | 190 |  61.26M |  329712 |
| M1            | 380 | 143.98M |  388929 |
| U1            | 190 |  30.72M |  164856 |
| U2            | 190 |  30.54M |  164856 |
| Us            |   0 |       0 |       0 |
| M.cor         | 337 | 205.63M | 1107570 |

| Group              |  Mean | Median | STDev | PercentOfPairs |
|:-------------------|------:|-------:|------:|---------------:|
| M.ihist.merge1.txt | 249.2 |    255 |  27.6 |         18.82% |
| M.ihist.merge.txt  | 370.0 |    364 |  71.5 |         70.51% |


Table: statQuorum

| Name     | CovIn | CovOut | Discard% |  Kmer | RealG |    EstG | Est/Real |   RunTime |
|:---------|------:|-------:|---------:|------:|------:|--------:|---------:|----------:|
| Q0L0.R   | 177.2 |  164.4 |    7.23% | "105" |    1M | 493.77K |     0.49 | 0:00'23'' |
| Q25L60.R | 168.7 |  161.0 |    4.60% | "105" |    1M | 329.78K |     0.33 | 0:00'22'' |


Table: statKunitigsAnchors.md

| Name           | CovCor | Mapped% | N50Anchor |    Sum |  # | N50Others |   Sum |  # | median |  MAD | lower | upper |                Kmer | RunTimeKU | RunTimeAN |
|:---------------|-------:|--------:|----------:|-------:|---:|----------:|------:|---:|-------:|-----:|------:|------:|--------------------:|----------:|----------:|
| Q0L0X40P000    |   40.0 |  15.41% |      2283 | 24.06K | 10 |      2215 | 7.39K | 23 |   28.0 |  5.0 |   4.3 |  56.0 | "31,41,51,61,71,81" | 0:00'04'' | 0:00'20'' |
| Q0L0X40P001    |   40.0 |  15.70% |      2401 | 25.01K | 11 |      2215 | 6.05K | 24 |   29.0 |  8.0 |   3.0 |  58.0 | "31,41,51,61,71,81" | 0:00'04'' | 0:00'20'' |
| Q0L0X40P002    |   40.0 |  15.62% |      2279 | 24.53K | 10 |      2215 | 5.74K | 22 |   30.0 |  6.5 |   3.5 |  60.0 | "31,41,51,61,71,81" | 0:00'04'' | 0:00'17'' |
| Q0L0X80P000    |   80.0 |  14.49% |      2427 |  26.6K | 11 |      1063 | 7.04K | 28 |   56.0 | 16.0 |   3.0 | 112.0 | "31,41,51,61,71,81" | 0:00'05'' | 0:00'18'' |
| Q0L0X80P001    |   80.0 |  15.82% |      2395 | 26.71K | 10 |      1672 | 5.97K | 26 |   55.0 | 17.5 |   3.0 | 110.0 | "31,41,51,61,71,81" | 0:00'05'' | 0:00'18'' |
| Q0L0X80P002    |   80.0 |  12.90% |      2471 | 24.74K | 11 |      1061 | 7.71K | 25 |   54.0 | 12.0 |   6.0 | 108.0 | "31,41,51,61,71,81" | 0:00'06'' | 0:00'18'' |
| Q0L0X120P000   |  120.0 |  13.90% |      2388 | 26.14K | 12 |      1016 | 6.97K | 29 |   82.0 | 20.5 |   6.8 | 164.0 | "31,41,51,61,71,81" | 0:00'07'' | 0:00'18'' |
| Q0L0X120P001   |  120.0 |   9.64% |      2632 | 23.27K | 11 |       864 | 6.75K | 25 |   77.0 | 14.0 |  11.7 | 154.0 | "31,41,51,61,71,81" | 0:00'07'' | 0:00'18'' |
| Q0L0X120P002   |  120.0 |  11.99% |      2856 | 22.98K |  9 |      1124 | 6.79K | 22 |   80.0 | 21.0 |   5.7 | 160.0 | "31,41,51,61,71,81" | 0:00'06'' | 0:00'18'' |
| Q0L0X160P000   |  160.0 |  12.69% |      2347 |  24.6K | 12 |      1000 | 8.56K | 33 |  102.0 | 22.0 |  12.0 | 204.0 | "31,41,51,61,71,81" | 0:00'09'' | 0:00'18'' |
| Q0L0X160P001   |  160.0 |   8.65% |      2543 |  22.5K | 10 |      1059 | 5.71K | 23 |  104.0 | 21.5 |  13.2 | 208.0 | "31,41,51,61,71,81" | 0:00'09'' | 0:00'19'' |
| Q0L0X160P002   |  160.0 |  11.97% |      2478 | 22.71K |  9 |      1081 | 6.71K | 24 |  111.0 | 19.0 |  18.0 | 222.0 | "31,41,51,61,71,81" | 0:00'09'' | 0:00'19'' |
| Q0L0X240P000   |  240.0 |   9.65% |      2504 | 22.52K | 11 |       875 | 6.91K | 27 |  153.0 | 31.0 |  20.0 | 306.0 | "31,41,51,61,71,81" | 0:00'11'' | 0:00'18'' |
| Q0L0X240P001   |  240.0 |   8.18% |      2523 | 22.27K | 10 |      1154 | 6.12K | 21 |  153.0 | 33.0 |  18.0 | 306.0 | "31,41,51,61,71,81" | 0:00'11'' | 0:00'19'' |
| Q0L0X240P002   |  240.0 |   8.18% |      2321 | 22.34K | 10 |      1091 | 5.16K | 20 |  161.0 | 36.0 |  17.7 | 322.0 | "31,41,51,61,71,81" | 0:00'11'' | 0:00'18'' |
| Q0L0X320P000   |  320.0 |   8.96% |      2515 |  20.4K | 10 |      1177 | 7.35K | 26 |  196.0 | 42.0 |  23.3 | 392.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'19'' |
| Q0L0X320P001   |  320.0 |   7.86% |      2522 | 20.93K |  9 |      1165 | 5.82K | 19 |  211.0 | 43.0 |  27.3 | 422.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'19'' |
| Q25L60X40P000  |   40.0 |  22.87% |      2371 | 24.47K | 10 |      2215 | 8.95K | 25 |   29.0 |  9.0 |   3.0 |  58.0 | "31,41,51,61,71,81" | 0:00'04'' | 0:00'18'' |
| Q25L60X40P001  |   40.0 |  16.49% |      2398 | 24.79K | 10 |      2215 | 5.72K | 26 |   29.0 |  8.5 |   3.0 |  58.0 | "31,41,51,61,71,81" | 0:00'04'' | 0:00'18'' |
| Q25L60X40P002  |   40.0 |  16.22% |      3805 | 25.03K |  9 |      2215 | 6.47K | 23 |   29.0 |  8.0 |   3.0 |  58.0 | "31,41,51,61,71,81" | 0:00'04'' | 0:00'18'' |
| Q25L60X80P000  |   80.0 |  16.75% |      3904 | 25.55K |  9 |      2215 | 8.38K | 24 |   56.0 | 18.0 |   3.0 | 112.0 | "31,41,51,61,71,81" | 0:00'06'' | 0:00'18'' |
| Q25L60X80P001  |   80.0 |  13.89% |      3908 | 26.36K | 10 |      1094 | 5.16K | 24 |   56.0 | 17.5 |   3.0 | 112.0 | "31,41,51,61,71,81" | 0:00'06'' | 0:00'18'' |
| Q25L60X80P002  |   80.0 |  16.87% |      3920 | 26.66K | 10 |      2215 | 7.35K | 26 |   58.0 | 18.0 |   3.0 | 116.0 | "31,41,51,61,71,81" | 0:00'05'' | 0:00'19'' |
| Q25L60X120P000 |  120.0 |  16.45% |      2702 | 28.67K | 12 |      1959 | 4.96K | 29 |   83.0 | 26.0 |   3.0 | 166.0 | "31,41,51,61,71,81" | 0:00'07'' | 0:00'19'' |
| Q25L60X120P001 |  120.0 |  15.06% |      4727 | 27.33K | 10 |      1350 | 6.33K | 24 |   85.0 | 25.5 |   3.0 | 170.0 | "31,41,51,61,71,81" | 0:00'06'' | 0:00'18'' |
| Q25L60X120P002 |  120.0 |  14.92% |      2945 | 28.81K | 12 |      1363 |  5.7K | 26 |   83.0 | 25.0 |   3.0 | 166.0 | "31,41,51,61,71,81" | 0:00'07'' | 0:00'18'' |
| Q25L60X160P000 |  160.0 |  17.95% |      2691 | 27.35K | 11 |      1094 | 6.07K | 31 |  112.0 | 34.0 |   3.3 | 224.0 | "31,41,51,61,71,81" | 0:00'08'' | 0:00'19'' |
| Q25L60X160P001 |  160.0 |  14.64% |      2619 | 29.33K | 12 |      2409 | 4.43K | 26 |  113.0 | 34.5 |   3.2 | 226.0 | "31,41,51,61,71,81" | 0:00'08'' | 0:00'19'' |
| Q25L60X160P002 |  160.0 |  12.46% |      2492 | 21.89K |  9 |      1109 |  7.9K | 25 |  112.0 | 24.0 |  13.3 | 224.0 | "31,41,51,61,71,81" | 0:00'08'' | 0:00'18'' |
| Q25L60X240P000 |  240.0 |  13.89% |      2959 |  26.4K | 11 |      1094 | 4.87K | 27 |  164.0 | 49.0 |   5.7 | 328.0 | "31,41,51,61,71,81" | 0:00'11'' | 0:00'18'' |
| Q25L60X240P001 |  240.0 |  10.39% |      2535 | 21.39K |  9 |      1151 | 6.77K | 24 |  168.0 | 39.0 |  17.0 | 336.0 | "31,41,51,61,71,81" | 0:00'11'' | 0:00'19'' |
| Q25L60X240P002 |  240.0 |   8.42% |      2379 | 22.62K | 10 |      1129 | 5.29K | 21 |  165.0 | 40.0 |  15.0 | 330.0 | "31,41,51,61,71,81" | 0:00'11'' | 0:00'19'' |
| Q25L60X320P000 |  320.0 |   8.80% |      2913 | 22.05K |  9 |      1005 | 3.39K | 20 |  227.0 | 63.0 |  12.7 | 454.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'19'' |
| Q25L60X320P001 |  320.0 |   9.32% |      2572 | 21.79K |  9 |      1109 | 4.63K | 20 |  232.0 | 66.0 |  11.3 | 464.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'19'' |


Table: statTadpoleAnchors.md

| Name           | CovCor | Mapped% | N50Anchor |    Sum |  # | N50Others |    Sum |  # | median |  MAD | lower | upper |                Kmer | RunTimeKU | RunTimeAN |
|:---------------|-------:|--------:|----------:|-------:|---:|----------:|-------:|---:|-------:|-----:|------:|------:|--------------------:|----------:|----------:|
| Q0L0X40P000    |   40.0 |  63.21% |      2332 | 24.93K | 10 |      4058 | 15.88K | 26 |   34.0 | 11.0 |   3.0 |  68.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'18'' |
| Q0L0X40P001    |   40.0 |  54.54% |      2401 | 26.56K | 11 |      6254 | 11.64K | 25 |   32.0 | 10.0 |   3.0 |  64.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'18'' |
| Q0L0X40P002    |   40.0 |  55.91% |      2050 | 31.04K | 13 |      2506 | 13.79K | 32 |   33.0 |  8.5 |   3.0 |  66.0 | "31,41,51,61,71,81" | 0:00'13'' | 0:00'18'' |
| Q0L0X80P000    |   80.0 |  54.56% |      2416 | 26.48K | 11 |      2506 | 13.67K | 27 |   61.0 | 21.0 |   3.0 | 122.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'18'' |
| Q0L0X80P001    |   80.0 |  54.91% |      2366 | 27.55K | 11 |      6325 | 11.72K | 26 |   61.0 | 21.0 |   3.0 | 122.0 | "31,41,51,61,71,81" | 0:00'13'' | 0:00'19'' |
| Q0L0X80P002    |   80.0 |  55.82% |      3922 | 26.83K |  9 |      2506 | 14.52K | 27 |   58.0 | 16.5 |   3.0 | 116.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'19'' |
| Q0L0X120P000   |  120.0 |  55.07% |      4674 | 28.53K | 11 |      2506 | 12.61K | 27 |   89.0 | 29.5 |   3.0 | 178.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'18'' |
| Q0L0X120P001   |  120.0 |  55.49% |      3121 | 29.35K | 10 |      6325 | 11.62K | 24 |   88.0 | 29.0 |   3.0 | 176.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'19'' |
| Q0L0X120P002   |  120.0 |  54.47% |      3909 | 26.97K | 10 |      2506 |  13.6K | 26 |   90.0 | 32.0 |   3.0 | 180.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'19'' |
| Q0L0X160P000   |  160.0 |  55.08% |      2736 | 29.94K | 11 |      6255 | 11.46K | 28 |  117.0 | 40.5 |   3.0 | 234.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |
| Q0L0X160P001   |  160.0 |  55.81% |      3175 | 28.59K | 11 |      6226 | 12.43K | 30 |  120.0 | 38.0 |   3.0 | 240.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'19'' |
| Q0L0X160P002   |  160.0 |  55.29% |      2681 | 29.38K | 11 |      6325 | 11.72K | 26 |  119.0 | 42.0 |   3.0 | 238.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'19'' |
| Q0L0X240P000   |  240.0 |  54.98% |      3185 | 29.81K | 10 |      6255 | 11.41K | 24 |  179.0 | 58.0 |   3.0 | 358.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'18'' |
| Q0L0X240P001   |  240.0 |  55.05% |      2695 | 29.75K | 11 |      6325 | 11.46K | 24 |  180.0 | 65.5 |   3.0 | 360.0 | "31,41,51,61,71,81" | 0:00'17'' | 0:00'19'' |
| Q0L0X240P002   |  240.0 |  54.77% |      3148 | 30.28K | 10 |      6254 | 11.37K | 21 |  183.0 | 72.0 |   3.0 | 366.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |
| Q0L0X320P000   |  320.0 |  55.03% |      3196 | 29.79K | 10 |      6325 | 11.38K | 21 |  241.0 | 84.0 |   3.0 | 482.0 | "31,41,51,61,71,81" | 0:00'18'' | 0:00'19'' |
| Q0L0X320P001   |  320.0 |  54.87% |      3155 | 30.45K | 10 |      6254 | 11.44K | 21 |  243.0 | 93.0 |   3.0 | 486.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'20'' |
| Q25L60X40P000  |   40.0 |  56.80% |      2589 | 26.45K | 10 |      6255 | 11.85K | 33 |   34.0 | 11.5 |   3.0 |  68.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'18'' |
| Q25L60X40P001  |   40.0 |  55.69% |      2499 | 25.75K | 10 |      6255 | 11.77K | 25 |   33.0 | 10.5 |   3.0 |  66.0 | "31,41,51,61,71,81" | 0:00'13'' | 0:00'18'' |
| Q25L60X40P002  |   40.0 |  55.32% |      3805 | 25.01K |  9 |      6255 | 11.74K | 21 |   32.0 |  9.5 |   3.0 |  64.0 | "31,41,51,61,71,81" | 0:00'13'' | 0:00'19'' |
| Q25L60X80P000  |   80.0 |  55.85% |      3899 | 25.73K |  9 |      2506 | 14.64K | 26 |   61.0 | 22.0 |   3.0 | 122.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'19'' |
| Q25L60X80P001  |   80.0 |  55.82% |      3908 | 25.86K |  9 |      6255 | 12.47K | 24 |   62.0 | 20.5 |   3.0 | 124.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'18'' |
| Q25L60X80P002  |   80.0 |  61.52% |      2400 | 26.77K | 11 |      2506 | 14.63K | 31 |   63.0 | 22.5 |   3.0 | 126.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'19'' |
| Q25L60X120P000 |  120.0 |  55.70% |      2702 | 28.14K | 11 |      6255 | 12.49K | 25 |   92.0 | 35.0 |   3.0 | 184.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'19'' |
| Q25L60X120P001 |  120.0 |  56.05% |      4686 | 27.81K | 10 |      2506 | 13.49K | 27 |   92.0 | 31.0 |   3.0 | 184.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'19'' |
| Q25L60X120P002 |  120.0 |  55.91% |      4732 | 28.72K | 11 |      2506 | 12.58K | 26 |   90.0 | 32.0 |   3.0 | 180.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'18'' |
| Q25L60X160P000 |  160.0 |  56.26% |      2702 | 30.04K | 12 |      6255 | 11.74K | 31 |  119.0 | 41.0 |   3.0 | 238.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'18'' |
| Q25L60X160P001 |  160.0 |  61.44% |      2743 |  29.9K | 11 |      7108 | 12.41K | 26 |  123.0 | 44.0 |   3.0 | 246.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |
| Q25L60X160P002 |  160.0 |  55.93% |      3101 | 29.98K | 10 |      6226 | 11.54K | 27 |  121.0 | 44.0 |   3.0 | 242.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'19'' |
| Q25L60X240P000 |  240.0 |  56.36% |      2740 | 30.35K | 11 |      6255 | 11.44K | 27 |  177.0 | 60.0 |   3.0 | 354.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |
| Q25L60X240P001 |  240.0 |  56.70% |      3125 | 30.19K | 10 |      6226 | 11.55K | 27 |  172.0 | 56.0 |   3.0 | 344.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'20'' |
| Q25L60X240P002 |  240.0 |  55.74% |      3159 | 29.79K | 10 |      6254 |  11.3K | 23 |  189.0 | 72.0 |   3.0 | 378.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'20'' |
| Q25L60X320P000 |  320.0 |  56.37% |      2764 | 30.42K | 11 |      6255 | 11.48K | 26 |  234.0 | 77.5 |   3.0 | 468.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'20'' |
| Q25L60X320P001 |  320.0 |  56.26% |      3176 | 30.32K | 10 |      6254 | 11.54K | 22 |  237.0 | 83.5 |   3.0 | 474.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'20'' |


Table: statMRKunitigsAnchors.md

| Name       | CovCor | Mapped% | N50Anchor |    Sum |  # | N50Others |    Sum |  # | median |   MAD | lower | upper |                Kmer | RunTimeKU | RunTimeAN |
|:-----------|-------:|--------:|----------:|-------:|---:|----------:|-------:|---:|-------:|------:|------:|------:|--------------------:|----------:|----------:|
| MRX40P000  |   40.0 |  52.54% |      2961 |  24.3K |  9 |      2506 | 14.56K | 22 |   31.0 |  13.0 |   3.0 |  62.0 | "31,41,51,61,71,81" | 0:00'05'' | 0:00'19'' |
| MRX40P001  |   40.0 |  51.34% |      2327 | 25.79K | 10 |      2374 | 13.18K | 24 |   33.0 |  12.5 |   3.0 |  66.0 | "31,41,51,61,71,81" | 0:00'05'' | 0:00'19'' |
| MRX40P002  |   40.0 |  51.31% |      2301 | 24.92K | 10 |      2506 |  12.8K | 24 |   33.0 |  12.5 |   3.0 |  66.0 | "31,41,51,61,71,81" | 0:00'05'' | 0:00'18'' |
| MRX80P000  |   80.0 |  51.10% |      2716 | 29.58K | 11 |      2540 | 11.58K | 27 |   61.0 |  22.0 |   3.0 | 122.0 | "31,41,51,61,71,81" | 0:00'06'' | 0:00'19'' |
| MRX80P001  |   80.0 |  50.34% |      4722 | 28.35K | 10 |      2506 |  11.6K | 24 |   64.0 |  24.5 |   3.0 | 128.0 | "31,41,51,61,71,81" | 0:00'06'' | 0:00'19'' |
| MRX80P002  |   80.0 |  53.38% |      2473 | 26.23K | 11 |      2506 | 14.43K | 28 |   62.0 |  26.0 |   3.0 | 124.0 | "31,41,51,61,71,81" | 0:00'06'' | 0:00'18'' |
| MRX120P000 |  120.0 |  50.28% |      3092 | 29.84K | 10 |      2468 | 11.16K | 23 |   93.0 |  34.5 |   3.0 | 186.0 | "31,41,51,61,71,81" | 0:00'08'' | 0:00'19'' |
| MRX120P001 |  120.0 |  50.03% |      3179 | 27.59K | 10 |      2506 | 12.49K | 26 |   95.0 |  46.0 |   3.0 | 190.0 | "31,41,51,61,71,81" | 0:00'08'' | 0:00'19'' |
| MRX120P002 |  120.0 |  51.41% |      2639 | 29.44K | 11 |      2506 | 11.52K | 25 |   90.0 |  35.0 |   3.0 | 180.0 | "31,41,51,61,71,81" | 0:00'08'' | 0:00'19'' |
| MRX160P000 |  160.0 |  48.15% |      3158 | 28.86K | 10 |      2374 |  11.2K | 24 |  128.0 |  50.0 |   3.0 | 256.0 | "31,41,51,61,71,81" | 0:00'10'' | 0:00'19'' |
| MRX160P001 |  160.0 |  51.24% |      3169 | 30.14K | 11 |      2506 | 11.43K | 24 |  125.0 |  49.0 |   3.0 | 250.0 | "31,41,51,61,71,81" | 0:00'10'' | 0:00'19'' |
| MRX160P002 |  160.0 |  51.03% |      3027 | 29.04K | 11 |      2506 | 11.72K | 24 |  125.0 |  41.0 |   3.0 | 250.0 | "31,41,51,61,71,81" | 0:00'10'' | 0:00'20'' |
| MRX240P000 |  240.0 |  47.97% |      2980 | 28.51K | 11 |      2374 | 11.29K | 25 |  192.0 |  76.5 |   3.0 | 384.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'20'' |
| MRX240P001 |  240.0 |  50.97% |      3027 | 29.56K | 11 |      2506 | 11.29K | 24 |  188.0 |  66.0 |   3.0 | 376.0 | "31,41,51,61,71,81" | 0:00'13'' | 0:00'20'' |
| MRX240P002 |  240.0 |  48.49% |      3158 | 28.64K | 11 |      2506 | 11.29K | 24 |  186.0 |  90.0 |   3.0 | 372.0 | "31,41,51,61,71,81" | 0:00'13'' | 0:00'19'' |
| MRX320P000 |  320.0 |  42.03% |      2980 | 28.64K | 11 |      2374 |  10.3K | 25 |  253.0 | 102.0 |   3.0 | 506.0 | "31,41,51,61,71,81" | 0:00'17'' | 0:00'20'' |
| MRX320P001 |  320.0 |  40.73% |      3042 | 28.82K | 11 |      2506 |  9.72K | 23 |  243.0 |  87.0 |   3.0 | 486.0 | "31,41,51,61,71,81" | 0:00'17'' | 0:00'20'' |
| MRX320P002 |  320.0 |  43.31% |      3193 | 29.17K | 11 |      2506 | 10.11K | 26 |  247.0 |  92.5 |   3.0 | 494.0 | "31,41,51,61,71,81" | 0:00'17'' | 0:00'20'' |


Table: statMRTadpoleAnchors.md

| Name       | CovCor | Mapped% | N50Anchor |    Sum |  # | N50Others |    Sum |  # | median |  MAD | lower | upper |                Kmer | RunTimeKU | RunTimeAN |
|:-----------|-------:|--------:|----------:|-------:|---:|----------:|-------:|---:|-------:|-----:|------:|------:|--------------------:|----------:|----------:|
| MRX40P000  |   40.0 |  54.89% |      2563 | 26.74K | 10 |      2506 | 14.72K | 33 |   32.0 |  9.0 |   3.0 |  64.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'19'' |
| MRX40P001  |   40.0 |  58.66% |      2327 | 25.86K | 10 |      7108 | 14.12K | 24 |   33.0 | 12.0 |   3.0 |  66.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'18'' |
| MRX40P002  |   40.0 |  59.89% |      2267 | 29.85K | 12 |      7108 | 12.99K | 31 |   34.0 |  9.0 |   3.0 |  68.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'18'' |
| MRX80P000  |   80.0 |  54.08% |      2711 | 28.94K | 11 |      2506 | 12.79K | 28 |   62.0 | 23.0 |   3.0 | 124.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'18'' |
| MRX80P001  |   80.0 |  59.11% |      3105 | 28.97K | 10 |      7108 | 12.59K | 25 |   65.0 | 23.5 |   3.0 | 130.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'18'' |
| MRX80P002  |   80.0 |  54.01% |      2473 | 26.71K | 11 |      2506 | 13.81K | 27 |   62.0 | 23.0 |   3.0 | 124.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'18'' |
| MRX120P000 |  120.0 |  53.97% |      3092 |  30.2K | 10 |      6325 | 11.49K | 25 |   93.0 | 33.0 |   3.0 | 186.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'19'' |
| MRX120P001 |  120.0 |  53.96% |      3179 | 29.32K | 11 |      6325 | 11.61K | 25 |   94.0 | 34.5 |   3.0 | 188.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'18'' |
| MRX120P002 |  120.0 |  58.98% |      2720 | 29.84K | 11 |      7108 | 12.41K | 24 |   94.0 | 35.0 |   3.0 | 188.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |
| MRX160P000 |  160.0 |  59.01% |      3158 | 30.29K | 10 |      7108 | 12.27K | 23 |  129.0 | 50.0 |   3.0 | 258.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |
| MRX160P001 |  160.0 |  59.10% |      3169 | 30.04K | 10 |      7108 | 12.27K | 21 |  126.0 | 46.0 |   3.0 | 252.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'18'' |
| MRX160P002 |  160.0 |  59.11% |      3184 | 30.23K | 10 |      7108 | 12.28K | 21 |  125.0 | 41.0 |   3.0 | 250.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'19'' |
| MRX240P000 |  240.0 |  53.89% |      3204 |  30.6K | 10 |      6325 | 11.34K | 21 |  191.0 | 72.0 |   3.0 | 382.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'20'' |
| MRX240P001 |  240.0 |  59.48% |      3186 | 30.51K | 10 |      7108 | 12.14K | 23 |  179.0 | 63.0 |   3.0 | 358.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |
| MRX240P002 |  240.0 |  59.70% |      2843 |  30.4K | 11 |      7108 | 12.27K | 23 |  172.0 | 64.0 |   3.0 | 344.0 | "31,41,51,61,71,81" | 0:00'17'' | 0:00'19'' |
| MRX320P000 |  320.0 |  59.02% |      3210 | 30.58K | 10 |      7108 | 12.06K | 21 |  255.0 | 98.0 |   3.0 | 510.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |
| MRX320P001 |  320.0 |  59.22% |      3219 | 30.69K | 10 |      7108 | 12.09K | 20 |  245.0 | 89.0 |   3.0 | 490.0 | "31,41,51,61,71,81" | 0:00'17'' | 0:00'19'' |
| MRX320P002 |  320.0 |  59.28% |      3193 |  30.5K | 10 |      7108 | 12.19K | 25 |  246.0 | 89.0 |   3.0 | 492.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |


Table: statMergeAnchors.md

| Name                     | Mapped% | N50Anchor |    Sum |  # | N50Others |    Sum |  # | median | MAD | lower | upper | RunTimeAN |
|:-------------------------|--------:|----------:|-------:|---:|----------:|-------:|---:|-------:|----:|------:|------:|----------:|
| 7_mergeAnchors           |   0.00% |      6580 | 37.19K |  9 |      2506 |  29.7K | 12 |    0.0 | 0.0 |   0.0 |   0.0 |           |
| 7_mergeKunitigsAnchors   |   0.00% |      3168 | 31.79K | 10 |      1248 |  18.3K | 13 |    0.0 | 0.0 |   0.0 |   0.0 |           |
| 7_mergeMRKunitigsAnchors |   0.00% |      3240 | 31.96K | 10 |      2506 | 14.26K |  6 |    0.0 | 0.0 |   0.0 |   0.0 |           |
| 7_mergeMRTadpoleAnchors  |   0.00% |      4963 |  35.7K | 10 |      2506 | 15.07K |  5 |    0.0 | 0.0 |   0.0 |   0.0 |           |
| 7_mergeTadpoleAnchors    |   0.00% |      5319 | 34.31K |  9 |      2506 | 27.47K | 10 |    0.0 | 0.0 |   0.0 |   0.0 |           |


Table: statOtherAnchors.md

| Name         | Mapped% | N50Anchor |    Sum |  # | N50Others |    Sum |  # | median |    MAD | lower |  upper | RunTimeAN |
|:-------------|--------:|----------:|-------:|---:|----------:|-------:|---:|-------:|-------:|------:|-------:|----------:|
| 8_spades     |  74.00% |      2886 | 41.52K | 15 |      2334 |  24.2K | 33 |  598.0 |  242.0 |   3.0 | 1196.0 | 0:00'21'' |
| 8_spades_MR  |  73.55% |      2871 | 41.72K | 16 |      9067 | 15.81K | 31 |  771.0 |  312.5 |   3.0 | 1542.0 | 0:00'22'' |
| 8_megahit    |  70.57% |      3275 | 33.54K | 11 |      2508 | 17.36K | 22 |  618.0 |  248.5 |   3.0 | 1236.0 | 0:00'22'' |
| 8_megahit_MR |  70.36% |      2792 | 46.82K | 21 |      8539 | 16.52K | 39 |  628.0 |  540.5 |   3.0 | 1256.0 | 0:00'21'' |
| 8_platanus   |  54.54% |      5012 |    10K |  2 |      7616 |  7.98K |  3 | 1866.0 | 1029.0 |   3.0 | 3732.0 | 0:00'22'' |


Table: statFinal

| Name                     |   N50 |    Sum |   # |
|:-------------------------|------:|-------:|----:|
| Genome                   | 85779 |  85779 |   1 |
| 7_mergeAnchors.anchors   |  6580 |  37191 |   9 |
| 7_mergeAnchors.others    |  2506 |  29699 |  12 |
| anchorLong               |  6580 |  37191 |   9 |
| anchorFill               |  6580 |  37191 |   9 |
| spades.contig            |   599 | 153944 | 553 |
| spades.scaffold          |   599 | 153954 | 552 |
| spades.non-contained     |  3013 |  65720 |  22 |
| spades_MR.contig         |   283 | 193734 | 629 |
| spades_MR.scaffold       |   283 | 193734 | 629 |
| spades_MR.non-contained  |  3281 |  57526 |  20 |
| megahit.contig           |   565 | 234499 | 433 |
| megahit.non-contained    |  4664 |  50898 |  16 |
| megahit_MR.contig        |   522 | 435066 | 921 |
| megahit_MR.non-contained |  2812 |  63347 |  26 |
| platanus.contig          |  2451 |  33358 |  45 |
| platanus.scaffold        |  5374 |  24452 |  35 |
| platanus.non-contained   |  5374 |  17977 |   3 |


# *Arabidopsis thaliana* Col-0 organelles

* Genome: GCF_000001735.3, TAIR10, 119.668 Mb
* Chloroplast: NC_000932, 154478 bp
* Mitochondrion: Y08501, 366924 bp

## col_0O: download

* Reference genome

```bash
mkdir -p ${HOME}/data/anchr/col_0O/1_genome
cd ${HOME}/data/anchr/col_0O/1_genome

for ACCESSION in "NC_000932" "Y08501"; do
    URL=$(printf "https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=nucleotide&rettype=%s&id=%s&retmode=text" "fasta" "${ACCESSION}");
    curl $URL -o ${ACCESSION}.fa
done

TAB=$'\t'
cat <<EOF > replace.tsv
NC_000932.1${TAB}Pt
Y08501.2${TAB}Mt
EOF

cat NC_000932.fa Y08501.fa |
    faops replace stdin replace.tsv stdout |
    faops order stdin <(echo Pt; echo Mt) genome.fa

faops size genome.fa 

```

* Illumina
    * SRR5216995
    * 15.5 Gb
    * ~129.5x

```bash
mkdir -p ${HOME}/data/anchr/col_0O/2_illumina
cd ${HOME}/data/anchr/col_0O/2_illumina

cp ${HOME}/data/anchr/col_0/2_illumina/SRR5216995_{1,2}.fastq.gz .

ln -fs SRR5216995_1.fastq.gz R1.fq.gz
ln -fs SRR5216995_2.fastq.gz R2.fq.gz

```

## col_0O: template

* Rsync to hpcc

```bash
rsync -avP \
    ~/data/anchr/col_0O/ \
    wangq@202.119.37.251:data/anchr/col_0O

# rsync -avP wangq@202.119.37.251:data/anchr/col_0O/ ~/data/anchr/col_0O

```


* template

```bash
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=col_0O

cd ${WORKING_DIR}/${BASE_NAME}

rm -f *.sh
anchr template \
    . \
    --basename ${BASE_NAME} \
    --queue mpi \
    --genome 1_000_000 \
    --fastqc \
    --kmergenie \
    --insertsize \
    --sgapreqc \
    --trim2 "--dedupe --cutoff 518 --cutk 31" \
    --qual2 "25" \
    --len2 "60" \
    --filter "adapter,artifact" \
    --mergereads \
    --ecphase "1,2,3" \
    --cov2 "40 80 120 160 240 320" \
    --tadpole \
    --splitp 100 \
    --statp 1 \
    --fillanchor \
    --xmx 110g \
    --parallel 24

```

## col_0O: run

```bash
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=col_0O

cd ${WORKING_DIR}/${BASE_NAME}
# rm -fr 4_*/ 6_*/ 7_*/ 8_*/ && rm -fr 2_illumina/trim 2_illumina/mergereads statReads.md 

bash 0_bsub.sh
# bkill -J "${BASE_NAME}-*"

# bash 0_master.sh
# bash 0_cleanup.sh

```

Table: statInsertSize

| Group             |  Mean | Median | STDev | PercentOfPairs/PairOrientation |
|:------------------|------:|-------:|------:|-------------------------------:|
| R.genome.bbtools  | 377.3 |    340 | 881.3 |                          6.45% |
| R.tadpole.bbtools | 338.6 |    319 | 116.4 |                         42.36% |
| R.genome.picard   | 395.5 |    377 | 107.7 |                             FR |
| R.genome.picard   | 252.4 |    264 |  50.2 |                             RF |
| R.tadpole.picard  | 376.6 |    360 | 108.5 |                             FR |
| R.tadpole.picard  | 253.3 |    265 |  52.0 |                             RF |


Table: statReads

| Name       |    N50 |    Sum |        # |
|:-----------|-------:|-------:|---------:|
| Genome     | 366924 | 521402 |        2 |
| Illumina.R |    301 | 15.53G | 53786130 |
| trim.R     |    267 |  2.92G | 11944756 |
| Q25L60     |    255 |  2.61G | 11560892 |


Table: statTrimReads

| Name     | N50 |    Sum |        # |
|:---------|----:|-------:|---------:|
| clumpify | 301 | 15.53G | 53779068 |
| highpass | 301 |  3.48G | 12071214 |
| trim     | 267 |  2.92G | 11944756 |
| filter   | 267 |  2.92G | 11944756 |
| R1       | 286 |   1.6G |  5972378 |
| R2       | 238 |  1.32G |  5972378 |
| Rs       |   0 |      0 |        0 |


```text
#R.trim
#Matched	198502	1.64442%
#Name	Reads	ReadsPct
Reverse_adapter	73157	0.60605%
TruSeq_Universal_Adapter	50573	0.41896%
pcr_dimer	19943	0.16521%
Nextera_LMP_Read2_External_Adapter	13148	0.10892%
PCR_Primers	12231	0.10132%
```

```text
#R.filter
#Matched	0	0.00000%
#Name	Reads	ReadsPct
```

```text
#R.peaks
#k	31
#unique_kmers	92457172
#main_peak	8362
#genome_size	179508
#haploid_genome_size	179508
#fold_coverage	7094
#haploid_fold_coverage	7094
#ploidy	1
#percent_repeat	69.605
#start	center	stop	max	volume
```


Table: statMergeReads

| Name          | N50 |     Sum |        # |
|:--------------|----:|--------:|---------:|
| clumped       | 267 |   2.92G | 11943248 |
| ecco          | 267 |   2.92G | 11943248 |
| eccc          | 267 |   2.92G | 11943248 |
| ecct          | 271 |   2.02G |  8129526 |
| extended      | 308 |   2.32G |  8129526 |
| merged.raw    | 409 |   1.43G |  3657340 |
| unmerged.raw  | 267 | 194.85M |   814846 |
| unmerged.trim | 267 | 194.85M |   814796 |
| M1            | 410 |   1.39G |  3543172 |
| U1            | 296 | 112.82M |   407398 |
| U2            | 223 |  82.03M |   407398 |
| Us            |   0 |       0 |        0 |
| M.cor         | 392 |   1.59G |  7901140 |

| Group              |  Mean | Median | STDev | PercentOfPairs |
|:-------------------|------:|-------:|------:|---------------:|
| M.ihist.merge1.txt | 326.2 |    327 |  88.5 |         52.54% |
| M.ihist.merge.txt  | 390.9 |    383 | 106.4 |         89.98% |


Table: statQuorum

| Name     |  CovIn | CovOut | Discard% |  Kmer | RealG |   EstG | Est/Real |   RunTime |
|:---------|-------:|-------:|---------:|------:|------:|-------:|---------:|----------:|
| Q0L0.R   | 2918.6 | 2362.2 |   19.07% | "127" |    1M | 13.79M |    13.79 | 0:04'16'' |
| Q25L60.R | 2614.0 | 2346.6 |   10.23% | "127" |    1M |  9.95M |     9.95 | 0:03'57'' |


Table: statKunitigsAnchors.md

| Name          | CovCor | Mapped% | N50Anchor |   Sum | # | N50Others |    Sum |  # | median | MAD | lower | upper |                Kmer | RunTimeKU | RunTimeAN |
|:--------------|-------:|--------:|----------:|------:|--:|----------:|-------:|---:|-------:|----:|------:|------:|--------------------:|----------:|----------:|
| Q0L0X40P000   |   40.0 |   0.13% |      1322 | 1.32K | 1 |      1398 |  4.91K |  5 |    9.0 | 2.5 |   3.0 |  18.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |
| Q0L0X40P001   |   40.0 |   0.07% |      1088 | 1.09K | 1 |      1688 |  2.89K |  4 |    8.0 | 1.0 |   3.0 |  16.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |
| Q25L60X40P000 |   40.0 |   0.36% |      1169 | 3.61K | 3 |      1560 | 12.32K | 15 |    9.0 | 3.0 |   3.0 |  18.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'17'' |
| Q25L60X40P001 |   40.0 |   0.20% |      1283 | 2.41K | 2 |      1042 |  5.82K |  7 |   11.0 | 3.0 |   3.0 |  22.0 | "31,41,51,61,71,81" | 0:00'14'' | 0:00'17'' |


Table: statTadpoleAnchors.md

| Name           | CovCor | Mapped% | N50Anchor |     Sum |  # | N50Others |    Sum |  # | median |   MAD | lower |  upper |                Kmer | RunTimeKU | RunTimeAN |
|:---------------|-------:|--------:|----------:|--------:|---:|----------:|-------:|---:|-------:|------:|------:|-------:|--------------------:|----------:|----------:|
| Q0L0X40P000    |   40.0 |  40.62% |      7702 | 111.31K | 22 |      2155 | 38.01K | 65 |   98.0 |  12.0 |  20.7 |  196.0 | "31,41,51,61,71,81" | 0:00'24'' | 0:00'22'' |
| Q0L0X40P001    |   40.0 |  40.17% |     13749 | 114.88K | 17 |      3524 | 32.98K | 46 |   99.0 |  12.5 |  20.5 |  198.0 | "31,41,51,61,71,81" | 0:00'22'' | 0:00'22'' |
| Q0L0X80P000    |   80.0 |  39.86% |     10710 | 112.83K | 18 |      2286 | 35.17K | 56 |  196.0 |  23.5 |  41.8 |  392.0 | "31,41,51,61,71,81" | 0:00'28'' | 0:00'19'' |
| Q0L0X80P001    |   80.0 |  40.07% |     10686 | 109.41K | 16 |      2172 | 40.96K | 56 |  192.0 |  20.5 |  43.5 |  380.2 | "31,41,51,61,71,81" | 0:00'26'' | 0:00'20'' |
| Q0L0X120P000   |  120.0 |  41.89% |     10718 | 115.11K | 20 |      2172 | 33.74K | 61 |  298.0 |  42.5 |  56.8 |  596.0 | "31,41,51,61,71,81" | 0:00'31'' | 0:00'20'' |
| Q0L0X120P001   |  120.0 |  39.95% |     10720 | 110.06K | 20 |      2098 | 40.97K | 64 |  284.0 |  57.0 |  37.7 |  568.0 | "31,41,51,61,71,81" | 0:00'31'' | 0:00'20'' |
| Q0L0X160P000   |  160.0 |  41.35% |     10714 | 114.14K | 18 |      2098 | 32.44K | 62 |  396.0 |  55.0 |  77.0 |  792.0 | "31,41,51,61,71,81" | 0:00'34'' | 0:00'20'' |
| Q0L0X160P001   |  160.0 |  40.37% |      7804 | 113.67K | 21 |      2131 |  34.4K | 68 |  392.0 |  59.0 |  71.7 |  784.0 | "31,41,51,61,71,81" | 0:00'33'' | 0:00'21'' |
| Q0L0X240P000   |  240.0 |  42.72% |     10691 | 116.67K | 18 |      2081 | 31.12K | 65 |  594.0 |  89.0 | 109.0 | 1188.0 | "31,41,51,61,71,81" | 0:00'40'' | 0:00'21'' |
| Q0L0X240P001   |  240.0 |  38.72% |     10705 | 115.61K | 18 |      2625 |  29.8K | 51 |  595.0 |  86.0 | 112.3 | 1190.0 | "31,41,51,61,71,81" | 0:00'40'' | 0:00'22'' |
| Q0L0X320P000   |  320.0 |  40.11% |     10712 | 117.85K | 19 |      2081 | 26.49K | 55 |  804.0 | 142.0 | 126.0 | 1608.0 | "31,41,51,61,71,81" | 0:00'46'' | 0:00'22'' |
| Q0L0X320P001   |  320.0 |  41.40% |      9368 | 115.67K | 18 |      2081 | 32.68K | 63 |  778.0 |  98.0 | 161.3 | 1556.0 | "31,41,51,61,71,81" | 0:00'43'' | 0:00'21'' |
| Q25L60X40P000  |   40.0 |  44.82% |     12799 | 128.34K | 19 |      3524 | 24.19K | 51 |  109.0 |  93.0 |   3.0 |  218.0 | "31,41,51,61,71,81" | 0:00'20'' | 0:00'19'' |
| Q25L60X40P001  |   40.0 |  43.78% |     10915 | 114.82K | 19 |      2591 | 34.98K | 57 |  110.0 |  15.0 |  21.7 |  220.0 | "31,41,51,61,71,81" | 0:00'21'' | 0:00'19'' |
| Q25L60X80P000  |   80.0 |  43.60% |     10707 | 114.95K | 18 |      2452 | 36.34K | 56 |  220.0 |  34.0 |  39.3 |  440.0 | "31,41,51,61,71,81" | 0:00'24'' | 0:00'19'' |
| Q25L60X80P001  |   80.0 |  46.88% |     13791 | 112.25K | 17 |      2500 | 42.85K | 63 |  208.0 |  29.5 |  39.8 |  416.0 | "31,41,51,61,71,81" | 0:00'25'' | 0:00'20'' |
| Q25L60X120P000 |  120.0 |  46.66% |     10707 | 116.44K | 17 |      2172 | 34.05K | 63 |  325.0 |  41.5 |  66.8 |  650.0 | "31,41,51,61,71,81" | 0:00'29'' | 0:00'20'' |
| Q25L60X120P001 |  120.0 |  46.21% |     12831 | 117.49K | 16 |      3102 | 30.77K | 53 |  330.0 |  38.5 |  71.5 |  660.0 | "31,41,51,61,71,81" | 0:00'29'' | 0:00'20'' |
| Q25L60X160P000 |  160.0 |  45.90% |     10712 | 117.27K | 16 |      3250 | 29.37K | 52 |  439.0 |  64.5 |  81.8 |  878.0 | "31,41,51,61,71,81" | 0:00'30'' | 0:00'20'' |
| Q25L60X160P001 |  160.0 |  42.09% |     10750 | 115.79K | 18 |      2081 |  34.8K | 57 |  434.0 |  57.5 |  87.2 |  868.0 | "31,41,51,61,71,81" | 0:00'30'' | 0:00'20'' |
| Q25L60X240P000 |  240.0 |  45.28% |     10705 | 115.89K | 16 |      3250 | 33.01K | 61 |  648.0 |  83.5 | 132.5 | 1296.0 | "31,41,51,61,71,81" | 0:00'36'' | 0:00'20'' |
| Q25L60X240P001 |  240.0 |  44.79% |     15444 | 116.24K | 14 |      2286 | 30.81K | 53 |  652.0 |  78.0 | 139.3 | 1304.0 | "31,41,51,61,71,81" | 0:00'36'' | 0:00'21'' |
| Q25L60X320P000 |  320.0 |  41.02% |     10723 |    116K | 16 |      2081 | 31.88K | 50 |  874.0 | 145.0 | 146.3 | 1748.0 | "31,41,51,61,71,81" | 0:00'41'' | 0:00'22'' |
| Q25L60X320P001 |  320.0 |  45.48% |     15450 | 114.16K | 14 |      2146 | 34.46K | 55 |  857.0 |  94.0 | 191.7 | 1708.5 | "31,41,51,61,71,81" | 0:00'41'' | 0:00'23'' |


Table: statMRKunitigsAnchors.md

| Name       | CovCor | Mapped% | N50Anchor |     Sum |  # | N50Others |    Sum |   # | median |   MAD | lower |  upper |                Kmer | RunTimeKU | RunTimeAN |
|:-----------|-------:|--------:|----------:|--------:|---:|----------:|-------:|----:|-------:|------:|------:|-------:|--------------------:|----------:|----------:|
| MRX40P000  |   40.0 |  62.51% |      7367 | 117.51K | 25 |      2126 | 27.74K |  56 |  171.0 |  50.0 |   7.0 |  342.0 | "31,41,51,61,71,81" | 0:00'13'' | 0:00'21'' |
| MRX40P001  |   40.0 |  60.32% |      5091 | 114.38K | 32 |      1554 |  30.6K |  76 |  168.0 |  40.0 |  16.0 |  336.0 | "31,41,51,61,71,81" | 0:00'13'' | 0:00'21'' |
| MRX80P000  |   80.0 |  50.47% |      3176 |  89.36K | 33 |      1645 | 42.54K |  87 |  325.0 |  61.5 |  46.8 |  650.0 | "31,41,51,61,71,81" | 0:00'22'' | 0:00'20'' |
| MRX80P001  |   80.0 |  50.44% |      2777 |   96.7K | 38 |      1564 | 36.37K |  93 |  324.0 |  67.0 |  41.0 |  648.0 | "31,41,51,61,71,81" | 0:00'22'' | 0:00'20'' |
| MRX120P000 |  120.0 |  43.08% |      2541 |  85.56K | 37 |      1364 | 32.26K |  96 |  473.0 | 111.0 |  46.7 |  946.0 | "31,41,51,61,71,81" | 0:00'31'' | 0:00'21'' |
| MRX120P001 |  120.0 |  41.41% |      1875 |  80.97K | 43 |      1187 |  34.5K | 104 |  467.0 |  93.0 |  62.7 |  934.0 | "31,41,51,61,71,81" | 0:00'31'' | 0:00'21'' |
| MRX160P000 |  160.0 |  37.12% |      2035 |  74.99K | 37 |      1300 | 36.85K | 102 |  606.0 | 149.0 |  53.0 | 1212.0 | "31,41,51,61,71,81" | 0:00'41'' | 0:00'21'' |
| MRX160P001 |  160.0 |  37.21% |      1856 |  72.93K | 41 |      1257 | 37.55K | 107 |  608.0 | 117.0 |  85.7 | 1216.0 | "31,41,51,61,71,81" | 0:00'41'' | 0:00'20'' |
| MRX240P000 |  240.0 |  24.96% |      1825 |  53.07K | 30 |      1316 |  33.9K |  85 |  830.0 | 206.0 |  70.7 | 1660.0 | "31,41,51,61,71,81" | 0:00'59'' | 0:00'21'' |
| MRX240P001 |  240.0 |  29.46% |      1702 |  55.58K | 34 |      1195 | 41.28K | 106 |  841.0 | 163.0 | 117.3 | 1682.0 | "31,41,51,61,71,81" | 0:01'00'' | 0:00'22'' |
| MRX320P000 |  320.0 |  14.30% |      1449 |  45.27K | 31 |      1381 | 14.51K |  39 |  763.0 | 316.0 |   3.0 | 1526.0 | "31,41,51,61,71,81" | 0:01'17'' | 0:00'22'' |
| MRX320P001 |  320.0 |  16.72% |      1506 |  41.23K | 26 |      1155 | 23.55K |  68 |  937.0 | 185.0 | 127.3 | 1874.0 | "31,41,51,61,71,81" | 0:01'17'' | 0:00'21'' |


Table: statMRTadpoleAnchors.md

| Name       | CovCor | Mapped% | N50Anchor |     Sum |  # | N50Others |    Sum |  # | median |    MAD | lower |  upper |                Kmer | RunTimeKU | RunTimeAN |
|:-----------|-------:|--------:|----------:|--------:|---:|----------:|-------:|---:|-------:|-------:|------:|-------:|--------------------:|----------:|----------:|
| MRX40P000  |   40.0 |  71.06% |     20625 | 134.03K | 17 |      3524 | 24.84K | 32 |  173.0 |  161.0 |   3.0 |  346.0 | "31,41,51,61,71,81" | 0:00'22'' | 0:00'22'' |
| MRX40P001  |   40.0 |  71.04% |     17935 | 133.79K | 18 |      3602 |    21K | 31 |  175.0 |  160.0 |   3.0 |  350.0 | "31,41,51,61,71,81" | 0:00'20'' | 0:00'22'' |
| MRX80P000  |   80.0 |  70.82% |     15525 | 133.82K | 18 |      3524 |  23.9K | 30 |  348.0 |  327.0 |   3.0 |  696.0 | "31,41,51,61,71,81" | 0:00'25'' | 0:00'20'' |
| MRX80P001  |   80.0 |  70.87% |     20099 | 133.14K | 19 |      3524 | 19.02K | 30 |  355.0 |  317.0 |   3.0 |  710.0 | "31,41,51,61,71,81" | 0:00'23'' | 0:00'21'' |
| MRX120P000 |  120.0 |  70.83% |     20099 | 131.53K | 17 |      3524 | 24.68K | 28 |  524.0 |  494.0 |   3.0 | 1048.0 | "31,41,51,61,71,81" | 0:00'25'' | 0:00'20'' |
| MRX120P001 |  120.0 |  73.06% |     17939 |  137.5K | 20 |      3211 |  17.2K | 33 |  526.0 |  479.5 |   3.0 | 1052.0 | "31,41,51,61,71,81" | 0:00'24'' | 0:00'21'' |
| MRX160P000 |  160.0 |  70.84% |     20099 | 131.28K | 18 |      3370 | 25.56K | 31 |  699.0 |  668.0 |   3.0 | 1398.0 | "31,41,51,61,71,81" | 0:00'27'' | 0:00'22'' |
| MRX160P001 |  160.0 |  71.19% |     17939 | 136.67K | 21 |      3312 | 18.45K | 31 |  701.0 |  650.5 |   3.0 | 1402.0 | "31,41,51,61,71,81" | 0:00'26'' | 0:00'21'' |
| MRX240P000 |  240.0 |  70.80% |     17940 | 133.62K | 19 |      3348 | 20.15K | 22 | 1053.0 |  983.5 |   3.0 | 2106.0 | "31,41,51,61,71,81" | 0:00'31'' | 0:00'22'' |
| MRX240P001 |  240.0 |  73.64% |     17940 | 135.04K | 19 |      3524 | 18.93K | 28 | 1049.0 |  974.5 |   3.0 | 2098.0 | "31,41,51,61,71,81" | 0:00'34'' | 0:00'21'' |
| MRX320P000 |  320.0 |  70.83% |     17940 | 135.86K | 21 |      3337 | 23.25K | 27 | 1396.0 | 1342.0 |   3.0 | 2792.0 | "31,41,51,61,71,81" | 0:00'35'' | 0:00'22'' |
| MRX320P001 |  320.0 |  70.67% |     17940 | 135.75K | 20 |      3471 | 17.73K | 24 | 1410.0 | 1315.0 |   3.0 | 2820.0 | "31,41,51,61,71,81" | 0:00'34'' | 0:00'23'' |


Table: statMergeAnchors.md

| Name                     | Mapped% | N50Anchor |     Sum |  # | N50Others |     Sum |   # | median | MAD | lower | upper | RunTimeAN |
|:-------------------------|--------:|----------:|--------:|---:|----------:|--------:|----:|-------:|----:|------:|------:|----------:|
| 7_mergeAnchors           |   0.00% |     17940 | 259.78K | 46 |      2120 | 196.77K |  99 |    0.0 | 0.0 |   0.0 |   0.0 |           |
| 7_mergeKunitigsAnchors   |   0.00% |      2177 |  28.62K | 16 |      1257 |  61.79K |  49 |    0.0 | 0.0 |   0.0 |   0.0 |           |
| 7_mergeMRKunitigsAnchors |   0.00% |     17913 | 143.92K | 25 |      2244 | 133.86K |  67 |    0.0 | 0.0 |   0.0 |   0.0 |           |
| 7_mergeMRTadpoleAnchors  |   0.00% |     17940 | 189.02K | 43 |      3602 |  98.54K |  44 |    0.0 | 0.0 |   0.0 |   0.0 |           |
| 7_mergeTadpoleAnchors    |   0.00% |     16762 | 245.55K | 36 |      2278 | 220.94K | 104 |    0.0 | 0.0 |   0.0 |   0.0 |           |


Table: statOtherAnchors.md

| Name         | Mapped% | N50Anchor |     Sum |  # | N50Others |     Sum |   # | median |    MAD | lower |   upper | RunTimeAN |
|:-------------|--------:|----------:|--------:|---:|----------:|--------:|----:|-------:|-------:|------:|--------:|----------:|
| 8_spades     |  34.85% |      1874 |  94.47K | 49 |     49279 | 192.91K | 132 |  684.0 |  613.0 |   3.0 |  1368.0 | 0:00'38'' |
| 8_spades_MR  |  69.43% |     18152 | 187.88K | 46 |      1593 |  46.27K | 102 | 6085.0 | 5981.0 |   3.0 | 12170.0 | 0:00'34'' |
| 8_megahit    |  21.87% |      5424 | 134.67K | 37 |      1068 |  13.71K |  37 | 4659.0 | 4169.0 |   3.0 |  9318.0 | 0:00'39'' |
| 8_megahit_MR |  73.85% |     18230 | 187.46K | 53 |      6669 |  44.16K | 104 | 6185.0 | 6110.0 |   3.0 | 12370.0 | 0:00'34'' |
| 8_platanus   |  37.72% |     84419 |  126.3K | 10 |      1885 |  17.25K |  12 | 5934.0 | 4840.0 |   3.0 | 11868.0 | 0:00'40'' |


Table: statFinal

| Name                     |    N50 |     Sum |     # |
|:-------------------------|-------:|--------:|------:|
| Genome                   | 366924 |  521402 |     2 |
| 7_mergeAnchors.anchors   |  17940 |  259780 |    46 |
| 7_mergeAnchors.others    |   2120 |  196766 |    99 |
| anchorLong               |  31622 |  251687 |    36 |
| anchorFill               |  46770 |  243440 |    30 |
| spades.contig            |     96 | 8132639 | 77301 |
| spades.scaffold          |     96 | 8132649 | 77300 |
| spades.non-contained     |   3866 |  287373 |    88 |
| spades_MR.contig         |    192 | 2096977 | 10202 |
| spades_MR.scaffold       |    192 | 2097277 | 10199 |
| spades_MR.non-contained  |  28821 |  234142 |    63 |
| megahit.contig           |    320 | 1010987 |  2863 |
| megahit.non-contained    |   5340 |  148384 |    48 |
| megahit_MR.contig        |    434 | 1859210 |  4375 |
| megahit_MR.non-contained |  18230 |  231622 |    69 |
| platanus.contig          |  15265 |  214449 |   216 |
| platanus.scaffold        |  84419 |  166379 |   111 |
| platanus.non-contained   |  84419 |  143546 |    11 |

# *Oryza sativa* Japonica Group Nipponbare organelles

* Genome: GCF_001433935.1, IRGSP-1.0, 374.423 Mb
* Chloroplast: NC_001320.1, 134525 bp
* Mitochondrion: NC_011033.1, 490520 bp

## nipO: download

* Reference genome

```bash
mkdir -p ${HOME}/data/anchr/nipO/1_genome
cd ${HOME}/data/anchr/nipO/1_genome

for ACCESSION in "NC_001320" "NC_011033"; do
    URL=$(printf "https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=nucleotide&rettype=%s&id=%s&retmode=text" "fasta" "${ACCESSION}");
    curl $URL -o ${ACCESSION}.fa
done

TAB=$'\t'
cat <<EOF > replace.tsv
NC_001320.1${TAB}Pt
NC_011033.1${TAB}Mt
EOF

cat NC_001320.fa NC_011033.fa |
    faops replace stdin replace.tsv stdout |
    faops order stdin <(echo Pt; echo Mt) genome.fa

faops size genome.fa 

```

* Illumina
    * SRR5216995
    * 15.5 Gb
    * ~129.5x

```bash
mkdir -p ${HOME}/data/anchr/nipO/2_illumina
cd ${HOME}/data/anchr/nipO/2_illumina

cp ${HOME}/data/anchr/nip/2_illumina/SRR5216995_{1,2}.fastq.gz .

ln -fs SRR5216995_1.fastq.gz R1.fq.gz
ln -fs SRR5216995_2.fastq.gz R2.fq.gz

```

## nipO: template

* Rsync to hpcc

```bash
rsync -avP \
    ~/data/anchr/nipO/ \
    wangq@202.119.37.251:data/anchr/nipO

# rsync -avP wangq@202.119.37.251:data/anchr/nipO/ ~/data/anchr/nipO

```


* template

```bash
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=nipO

cd ${WORKING_DIR}/${BASE_NAME}

rm -f *.sh
anchr template \
    . \
    --basename ${BASE_NAME} \
    --queue mpi \
    --genome 1_000_000 \
    --fastqc \
    --kmergenie \
    --insertsize \
    --sgapreqc \
    --trim2 "--dedupe --cutoff 518 --cutk 31" \
    --qual2 "25" \
    --len2 "60" \
    --filter "adapter,artifact" \
    --mergereads \
    --ecphase "1,2,3" \
    --cov2 "40 80 120 160 240 320" \
    --tadpole \
    --splitp 100 \
    --statp 1 \
    --fillanchor \
    --xmx 110g \
    --parallel 24

```

## nipO: run

```bash
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=nipO

cd ${WORKING_DIR}/${BASE_NAME}
# rm -fr 4_*/ 6_*/ 7_*/ 8_*/ && rm -fr 2_illumina/trim 2_illumina/mergereads statReads.md 

bash 0_bsub.sh
# bkill -J "${BASE_NAME}-*"

# bash 0_master.sh
# bash 0_cleanup.sh

```

